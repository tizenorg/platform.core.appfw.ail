#AIL init DB build script

SET(CREATEDB ail_createdb)
SET(CREATESRCS src/createdb.c ../src/ail_db.c)

SET(CREATE_DB_USER ail_createdb_user)
SET(CREATEUSERSRCS src/createdb_user.c ../src/ail_db.c)

SET(SYNCDB ail_syncdb)
SET(SYNCSRCS src/syncdb.c ../src/ail_db.c)

SET(SYNCDB_USER ail_syncdb_user)
SET(SYNCUSERSRCS src/syncdb_user.c  ../src/ail_db.c)

#obsolete tools
SET(INITDB ail_initdb)
SET(SRCS src/initdb.c ../src/ail_db.c)

SET(INITDB_USER ail_initdb_user)
SET(USERSRCS src/initdb_user.c  ../src/ail_db.c)

SET(FOTA ail_fota)
SET(FOTASRCS src/ail_fota.c)

SET(DESKTOP ail_desktop)
SET(DESKSRCS src/ail_desktop.c)

SET(FILTER ail_filter)
SET(FILTERSRCS src/ail_filter.c)

SET(LIST ail_list)
SET(LISTSRCS src/ail_list.c)

SET(PKG ail_package)
SET(PKGSRCS src/ail_package.c)

pkg_check_modules(INITDB_PKGS REQUIRED libsmack vconf dlog db-util sqlite3)
INCLUDE_DIRECTORIES(${CMAKE_SOURCE_DIR}/include)
INCLUDE_DIRECTORIES(${CMAKE_SOURCE_DIR}/src)

STRING(REPLACE ";" " " EXTRA_CFLAGS "${INITDB_PKGS_CFLAGS}")

ADD_EXECUTABLE(${CREATEDB_USER} ${CREATEUSERSRCS})
TARGET_LINK_LIBRARIES(${CREATEDB_USER} ${LIBNAME} ${INITDB_PKGS_LIBRARIES})
SET_TARGET_PROPERTIES(${CREATEDB_USER} PROPERTIES COMPILE_FLAGS "${EXTRA_CFLAGS}")
SET_TARGET_PROPERTIES(${CREATEDB_USER} PROPERTIES SKIP_BUILD_RPATH true)

INSTALL(TARGETS ${CREATEDB} DESTINATION ${BINDIR})

ADD_EXECUTABLE(${CREATEDB} ${CREATESRCS})
TARGET_LINK_LIBRARIES(${CREATEDB} ${LIBNAME} ${INITDB_PKGS_LIBRARIES})
SET_TARGET_PROPERTIES(${CREATEDB} PROPERTIES COMPILE_FLAGS "${EXTRA_CFLAGS}")
SET_TARGET_PROPERTIES(${CREATEDB} PROPERTIES SKIP_BUILD_RPATH true)

INSTALL(TARGETS ${CREATEDB} DESTINATION ${BINDIR})

ADD_EXECUTABLE(${SYNCDB} ${SYNCSRCS})
TARGET_LINK_LIBRARIES(${SYNCDB} ${LIBNAME} ${INITDB_PKGS_LIBRARIES})
SET_TARGET_PROPERTIES(${SYNCDB} PROPERTIES COMPILE_FLAGS "${EXTRA_CFLAGS}")
SET_TARGET_PROPERTIES(${SYNCDB} PROPERTIES SKIP_BUILD_RPATH true)

INSTALL(TARGETS ${SYNCDB} DESTINATION ${BINDIR})


ADD_EXECUTABLE(${SYNCDB_USER} ${SYNCUSERSRCS})
TARGET_LINK_LIBRARIES(${SYNCDB_USER} ${LIBNAME} ${INITDB_PKGS_LIBRARIES})
SET_TARGET_PROPERTIES(${SYNCDB_USER} PROPERTIES COMPILE_FLAGS "${EXTRA_CFLAGS}")
SET_TARGET_PROPERTIES(${SYNCDB_USER} PROPERTIES SKIP_BUILD_RPATH true)

INSTALL(TARGETS ${SYNCDB_USER} DESTINATION ${BINDIR})

ADD_EXECUTABLE(${INITDB} ${SRCS})
TARGET_LINK_LIBRARIES(${INITDB} ${LIBNAME} ${INITDB_PKGS_LIBRARIES})
SET_TARGET_PROPERTIES(${INITDB} PROPERTIES COMPILE_FLAGS "${EXTRA_CFLAGS}")
SET_TARGET_PROPERTIES(${INITDB} PROPERTIES SKIP_BUILD_RPATH true)

INSTALL(TARGETS ${INITDB} DESTINATION ${BINDIR})

ADD_EXECUTABLE(${INITDB_USER} ${USERSRCS})
TARGET_LINK_LIBRARIES(${INITDB_USER} ${LIBNAME} ${INITDB_PKGS_LIBRARIES})
SET_TARGET_PROPERTIES(${INITDB_USER} PROPERTIES COMPILE_FLAGS "${EXTRA_CFLAGS}")
SET_TARGET_PROPERTIES(${INITDB_USER} PROPERTIES SKIP_BUILD_RPATH true)

INSTALL(TARGETS ${INITDB_USER} DESTINATION ${BINDIR})

ADD_EXECUTABLE(${FOTA} ${FOTASRCS})
TARGET_LINK_LIBRARIES(${FOTA} ${LIBNAME} ${INITDB_PKGS_LIBRARIES})
SET_TARGET_PROPERTIES(${FOTA} PROPERTIES COMPILE_FLAGS "${EXTRA_CFLAGS}")
SET_TARGET_PROPERTIES(${FOTA} PROPERTIES SKIP_BUILD_RPATH true)

INSTALL(TARGETS ${FOTA} DESTINATION ${BINDIR})

ADD_EXECUTABLE(${DESKTOP} ${DESKSRCS})
TARGET_LINK_LIBRARIES(${DESKTOP} ${LIBNAME} ${INITDB_PKGS_LIBRARIES})
SET_TARGET_PROPERTIES(${DESKTOP} PROPERTIES COMPILE_FLAGS "${EXTRA_CFLAGS}")
SET_TARGET_PROPERTIES(${DESKTOP} PROPERTIES SKIP_BUILD_RPATH true)

INSTALL(TARGETS ${DESKTOP} DESTINATION ${BINDIR})

ADD_EXECUTABLE(${FILTER} ${FILTERSRCS})
TARGET_LINK_LIBRARIES(${FILTER} ${LIBNAME} ${INITDB_PKGS_LIBRARIES})
SET_TARGET_PROPERTIES(${FILTER} PROPERTIES COMPILE_FLAGS "${EXTRA_CFLAGS}")
SET_TARGET_PROPERTIES(${FILTER} PROPERTIES SKIP_BUILD_RPATH true)

INSTALL(TARGETS ${FILTER} DESTINATION ${BINDIR})


ADD_EXECUTABLE(${LIST} ${LISTSRCS})
TARGET_LINK_LIBRARIES(${LIST} ${LIBNAME} ${INITDB_PKGS_LIBRARIES})
SET_TARGET_PROPERTIES(${LIST} PROPERTIES COMPILE_FLAGS "${EXTRA_CFLAGS}")
SET_TARGET_PROPERTIES(${LIST} PROPERTIES SKIP_BUILD_RPATH true)

INSTALL(TARGETS ${LIST} DESTINATION ${BINDIR})


ADD_EXECUTABLE(${PKG} ${PKGSRCS})
TARGET_LINK_LIBRARIES(${PKG} ${LIBNAME} ${INITDB_PKGS_LIBRARIES})
SET_TARGET_PROPERTIES(${PKG} PROPERTIES COMPILE_FLAGS "${EXTRA_CFLAGS}")
SET_TARGET_PROPERTIES(${PKG} PROPERTIES SKIP_BUILD_RPATH true)

INSTALL(TARGETS ${PKG} DESTINATION ${BINDIR})
